import sys
import json
import random
from decimal import Decimal
from scipy.optimize import minimize, basinhopping
import skopt
import numpy as np
from pdb import set_trace as bp


class Nutrient(object):
    def __init__(self, name, minimum, maximum):
        self.name = name
        self.minimum = minimum
        self.maximum = maximum

    def __str__(self):
        return self.name


class Ingredient(object):
    def __init__(self, name, price, provides, minimum=0, maximum=100):
        self.name = name
        self.price = price
        self.provides = provides
        self.minimum = minimum
        self.maximum = maximum

    def __str__(self):
        return self.name


def add_nutrient_cost_both(nutrient_amounts, modifiers, debug):
    extra_cost = 0
    for nutrient, nutrient_amount in nutrient_amounts.values():
        add_to_cost = 0
        increase = modifiers['increase']
        percentage_tune = modifiers['percentage_tune']
        
        if nutrient_amount < nutrient.minimum:
            diff = nutrient.minimum - nutrient_amount # 
            percentage_diff = (diff / nutrient.minimum) * 100
            # add_to_cost += (diff / increase) ** 2
            add_to_cost += (diff / increase)
            add_to_cost += (percentage_diff / percentage_tune) ** 2

        elif nutrient_amount > nutrient.maximum:
            diff = nutrient_amount - nutrient.maximum
            percentage_diff = (diff / nutrient.maximum) * 100
            add_to_cost += (diff * increase) ** 2
            add_to_cost += (percentage_diff / percentage_tune) ** 2
        if add_to_cost:
            extra_cost += add_to_cost
            if debug:
                print('{}: {} < {:.5f} < {}: diff: {:.3f} {:.2f}%'.format(
                    nutrient, nutrient.minimum, nutrient_amount, nutrient.maximum, diff,
                    percentage_diff
                ))
    return extra_cost


def find_cost(ingredient_amounts, base_cost=False, modifiers={'increase': 10, 'percentage_tune': 6}, debug=False):
    amounts_and_cost = get_nutrient_amounts(ingredient_amounts)
    nutrient_amounts = amounts_and_cost[0]
    cost = amounts_and_cost[1]

    if not base_cost:
        cost += add_nutrient_cost_both(nutrient_amounts, modifiers, debug)
        # cost += add_nutrient_cost_flat(nutrient_amounts)

    return cost


def add_nutrient_cost(nutrient_amounts):
    extra_cost = 0
    
    for nutrient, nutrient_amount in nutrient_amounts.values():
        add_to_cost = 0
        
        if round(nutrient_amount, 2) < round(nutrient.minimum):

            diff = nutrient.minimum - nutrient_amount 

            add_to_cost += diff * 11

        if add_to_cost:
            extra_cost += add_to_cost

    return extra_cost

def find_cost2(ingredient_amounts, base_cost=False):
    amounts_and_cost = get_nutrient_amounts(ingredient_amounts)
    nutrient_amounts = amounts_and_cost[0]
    cost = amounts_and_cost[1]

    if not base_cost:
        cost += add_nutrient_cost(nutrient_amounts)

    return cost


def get_nutrient_amounts(ingredient_amounts):
    cost = 0
    nutrient_amounts = {}
    balanced_nutrients = {}
    for name, nutrient in nutrients.iteritems():
        nutrient_amounts[name] = [nutrient, 0]

    is_balanced = True

    total_amount = sum(x for x in ingredient_amounts if x > 0)
    for x, ingredient in enumerate(ingredients):

        percent = 0
        if total_amount != 0:
            percent = max(ingredient_amounts[x] / total_amount, 0)

        cost += ingredient.price * percent
        for nutrient in ingredient.provides:
            nutrient_amounts[nutrient[0]][1] += nutrient[1] * percent

            if round(nutrient_amounts[nutrient[0]][1], 2) >= ingredient.minimum and nutrient_amounts[nutrient[0]][1] <= ingredient.maximum:
                balanced_nutrients[nutrient[0]] = True
            else:
                balanced_nutrients[nutrient[0]] = False

    return [nutrient_amounts, cost, total_amount, all(balanced_nutrients.values())]


def accept_test(**kwargs):

    if kwargs['f_new'] < kwargs['f_old']:
        info = get_nutrient_amounts(kwargs['x_new'])

        if info[3]:
            return True
    else:
        old = get_nutrient_amounts(kwargs['x_old'])
        new = get_nutrient_amounts(kwargs['x_new'])

        if not old[3] and new[3]:
            return True

    return False

    # x_new = kwargs.pop('x_new')
    # print('{}: {}'.format(x_new, all(x >= 0 for x in x_new)))
    # return all(x >= 0 for x in x_new)


def print_fun(x, f, accepted):
    print("at minima %.4f accepted %d" % (f, int(accepted)))

# https://docs.scipy.org/doc/scipy-0.19.0/reference/generated/scipy.optimize.minimize.html
def basin_hopping(initial):

    # mytakestep = MyTakeStep()
    # mybounds = MyBoundaries()

    # minimizer_kwargs = {"method":"Nelder-Mead"} #21.48, calcium .3
    minimizer_kwargs = {"method":"Powell"} # 19.40, Phos .14
    # minimizer_kwargs = {"method":"CG"} # 20.85, balanced
    # minimizer_kwargs = {"method":"BFGS"} # 20.85
    # minimizer_kwargs = {"method":"TNC"} #19.67, protien .19
    # minimizer_kwargs = {"method":"COBYLA"} #21.06 Phos .07
    # minimizer_kwargs = {"method":"SLSQP"} #20.36 Phos .21


    ret = basinhopping(find_cost, initial, niter=150, stepsize=1.5, interval=10)
    best_ration = ret.x
    info = get_nutrient_amounts(best_ration)
    print_results(best_ration, info)
    result_amounts = ["{:4f}".format((max(x, 0) / info[2]) * 100) for x in best_ration]
    print(result_amounts)

    # J1
    # best_ration = [9.874915, 0.000000, 0.000000, 1.953607, 1.084227, 0.000000, 3.145987, 18.141387, 0.000000, 65.274137, 0.000000, 0.383916, 0.141824, 0.000000, 0.000000]

    # ret2 = basinhopping(find_cost, best_ration, niter=100, stepsize=0.05, interval=10, T=0.004, accept_test=accept_test)
    # best_ration = ret2.x
    # info = get_nutrient_amounts(best_ration)
    # print_results(best_ration, info)

    # result_amounts = ["{:4f}".format((max(x, 0) / info[2]) * 100) for x in best_ration]
    # print(result_amounts)
    
    if not send_to_ruby: print('------')
    if not send_to_ruby: print('------')
    if not send_to_ruby: print('------')

def print_results(best_ration, info):
    info = get_nutrient_amounts(best_ration)

    # dollar_cost = find_cost(ret.x, base_cost=True)
    if not send_to_ruby: print('Cost per KG ${:.2f}, at percent: {:.2f}'.format(info[1], info[2]))

    for y, ingredient in enumerate(ingredients):
        if not send_to_ruby: print('{}: {:.5f}%'.format(ingredient, (max(best_ration[y], 0) / info[2]) * 100))

    amounts = info[0]

    for nut_name, values in amounts.iteritems():
        diff = round(values[0].minimum - values[1], 2)

        if diff > 0.005:
            if not send_to_ruby: print('{} was under the minimum by {:.3f}').format(nut_name, diff)
        elif values[0].maximum < values[1]:
            if not send_to_ruby: print('{} over by {:.2f}').format(nut_name, values[1] - values[0].maximum)

    if not send_to_ruby: print('------')
  

def find_rations():
    # initial = [2.81, 4.45, 52.5, 0, 27.66, 6.875, 0, 3.5, 2.1149, .0084, .07, .0046]
    # initial = [1, 2, 3, 4, 5, 10, 15, 21, 31, 41, 51, 61]
    # initial = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
    # random.shuffle(initial)
    # bfgs(initial)
    # forest(initial)
    basin_hopping(initial)

initial = []
nutrients = {}
ingredients = []

# B1 ration: 23.73
test_json = {"nutrient_chart":[{"nutrient_type_name":"Calcium","product_type_name":"Barley","amount":"0.05","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"260.0"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"170.25","nutrient_value_per_unit_price":"254.1044776119402985"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat, 12.3% prot","amount":"3035.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"226.492537313432835820895522389"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Barley","amount":"0.085","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"223.5294117647058824"},{"nutrient_type_name":"Crude Fiber","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"217.1641791044776119"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler grower 75832","amount":"0.82","weighted_avg_purchased_price":"175.0","nutrient_value_per_unit_price":"213.4146341463414634"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Corn","amount":"3310.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"213.230773897192075103702194647184114255"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler finisher 75833","amount":"0.84","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"191.6666666666666667"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler grower 75832","amount":"0.77","weighted_avg_purchased_price":"133.5","nutrient_value_per_unit_price":"173.3766233766233766"},{"nutrient_type_name":"Dig. Valine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.86","weighted_avg_purchased_price":"142.2091227243633938","nutrient_value_per_unit_price":"165.3594450283295277"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Soya oil","amount":"7500.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"127.118644067796610169"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Barley","amount":"0.12","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"108.3333333333333333"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Barley","amount":"0.222","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"85.5855855855855856"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat Mids","amount":"0.14","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"78.5714285714285714"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM full fat","amount":"3064.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"74.188861985472154963680387409"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler finisher 75833","amount":"2.2","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"73.1818181818181818"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler grower 75832","amount":"2.2","weighted_avg_purchased_price":"156.0","nutrient_value_per_unit_price":"70.9090909090909091"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Barley","amount":"0.273","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"69.5970695970695971"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat Mids","amount":"0.167","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"65.8682634730538922"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Sunflower 34 Extracted","amount":"1203.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"59.554455445544554455445544554"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM Expelled 43 / 4","amount":"2211.0","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"55.137157107231920199501246883"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Barley","amount":"0.244","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"53.2786885245901639"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Barley","amount":"0.216","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"48.6111111111111111"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat Mids","amount":"0.29","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"37.9310344827586207"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"4.83","weighted_avg_purchased_price":"179.7902752779305749","nutrient_value_per_unit_price":"37.2236594778324172"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler grower 75832","amount":"6.5","weighted_avg_purchased_price":"240.1272727272727273","nutrient_value_per_unit_price":"36.9426573426573427"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat Mids","amount":"0.343","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"32.0699708454810496"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat Mids","amount":"0.367","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"29.9727520435967302"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Barley","amount":"0.352","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"29.8295454545454545"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Barley","amount":"0.383","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"27.4151436031331593"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat Mids","amount":"0.426","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"25.8215962441314554"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat Mids","amount":"0.441","weighted_avg_purchased_price":"9.8","nutrient_value_per_unit_price":"22.2222222222222222"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler finisher 75833","amount":"6.5","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"21.3076923076923077"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat Mids","amount":"0.539","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"20.4081632653061224"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler finisher 75833","amount":"8.35","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"19.281437125748503"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Lysine","amount":"3500.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"17.5"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler Start 75831","amount":"2468.0","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"15.425"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"9.74","weighted_avg_purchased_price":"142.7041763482163898","nutrient_value_per_unit_price":"14.6513528078250914"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Threonine","amount":"3000.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"14.634146341463414634"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone","amount":"36.0","weighted_avg_purchased_price":"2.6","nutrient_value_per_unit_price":"13.846153846153846153846153847"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"13.31","weighted_avg_purchased_price":"158.34038564270942819429168077128541885638855","nutrient_value_per_unit_price":"11.89634753138312758785061463345495258124632"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Methionine","amount":"4700.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"11.604938271604938272"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat Mids","amount":"0.871","weighted_avg_purchased_price":"9.92195994281566973","nutrient_value_per_unit_price":"11.39145802849101002"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler finisher 75833","amount":"15.05","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"10.6976744186046512"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler finisher 75833","amount":"15.4","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"10.4545454545454545"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler grower 75832","amount":"13.67","weighted_avg_purchased_price":"133.5","nutrient_value_per_unit_price":"9.7659107534747623"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler grower 75832","amount":"16.0","weighted_avg_purchased_price":"156.0","nutrient_value_per_unit_price":"9.75"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler finisher 75833","amount":"14.5","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"9.5517241379310345"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"17.21","weighted_avg_purchased_price":"153.44581470995362142879621674116018551429076","nutrient_value_per_unit_price":"8.91608452701648003653667732371645470739633"},{"nutrient_type_name":"Fat","product_type_name":"Barley","amount":"2.0","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"5.25"},{"nutrient_type_name":"Crude Protein","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"29.4","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"4.9489795918367347"},{"nutrient_type_name":"Fat","product_type_name":"Wheat Mids","amount":"3.2","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"3.4375"},{"nutrient_type_name":"Fat","product_type_name":"Soya oil","amount":"100.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"1.694915254237288136"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Barley","amount":"6.2","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.6935483870967742"},{"nutrient_type_name":"Crude Protein","product_type_name":"Sunflower 34 Extracted","amount":"31.7","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.569306930693069306930693069"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Sunflower 34 Extracted","amount":"23.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.138613861386138613861386139"},{"nutrient_type_name":"Crude Protein","product_type_name":"Barley","amount":"9.5","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.1052631578947368"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM Expelled 43 / 4","amount":"43.1","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"1.074812967581047381546134663"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat Mids","amount":"11.0","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"1.0"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat, 12.3% prot","amount":"12.3","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.917910447761194029850746269"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM full fat","amount":"36.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.871670702179176755447941889"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat Mids","amount":"15.3","weighted_avg_purchased_price":"9.97054583725054306","nutrient_value_per_unit_price":"0.65166966256539497124"},{"nutrient_type_name":"Crude Protein","product_type_name":"Corn","amount":"7.8","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.502477352386132382419600337839285828"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Threonine","amount":"98.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.478048780487804878"},{"nutrient_type_name":"Crude Protein","product_type_name":"Lysine","amount":"95.6","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.478"},{"nutrient_type_name":"Fat","product_type_name":"SBM full fat","amount":"19.5","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.472154963680387409200968524"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Lysine","amount":"79.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.395"},{"nutrient_type_name":"Crude Protein","product_type_name":"Threonine","amount":"60.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.292682926829268293"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Mononcalcium Phosphate","amount":"19.29","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.287910447761194029850746269"},{"nutrient_type_name":"Calcium","product_type_name":"Mononcalcium Phosphate","amount":"18.0","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.268656716417910448"},{"nutrient_type_name":"Fat","product_type_name":"Corn","amount":"4.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.257680693531349939702359147609890168"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler Start 75831","amount":"40.9","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.255625"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Methionine","amount":"99.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.244444444444444444"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat, 12.3% prot","amount":"3.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.223880597014925373134328358"},{"nutrient_type_name":"Fat","product_type_name":"SBM Expelled 43 / 4","amount":"6.2","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.154613466334164588528678304"},{"nutrient_type_name":"Crude Protein","product_type_name":"Methionine","amount":"58.7","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.144938271604938271604938272"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM Expelled 43 / 4","amount":"5.8","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.144638403990024937655860349"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM full fat","amount":"5.4","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.130750605326876513317191283"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Corn","amount":"2.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.128840346765674969851179573804945084"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler Start 75831","amount":"19.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.121875"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Sunflower 34 Extracted","amount":"2.337","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.115693069306930693069306931"},{"nutrient_type_name":"Fat","product_type_name":"Wheat, 12.3% prot","amount":"1.5","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.111940298507462686567164179"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler Start 75831","amount":"17.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.109375"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"1800.0","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"0.08083333333333333333"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler Start 75831","amount":"12.0","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.075"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM Expelled 43 / 4","amount":"2.808","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.070024937655860349127182045"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Sunflower 34 Extracted","amount":"1.336","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.066138613861386138613861386"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM full fat","amount":"2.344","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.05675544794188861985472155"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Sunflower 34 Extracted","amount":"1.144","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.056633663366336633663366337"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM Expelled 43 / 4","amount":"2.262","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.056408977556109725685785536"},{"nutrient_type_name":"Fat","product_type_name":"Sunflower 34 Extracted","amount":"1.1","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.054455445544554455445544554"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler Start 75831","amount":"8.35","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0521875"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Sunflower 34 Extracted","amount":"1.02","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.050495049504950495049504951"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Sunflower 34 Extracted","amount":"0.95","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.04702970297029702970297029702970297"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler Start 75831","amount":"7.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.046875"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM Expelled 43 / 4","amount":"1.759","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.043865336658354114713216958"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM full fat","amount":"1.779","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.043075060532687651331719128"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Sunflower 34 Extracted","amount":"0.865","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.042821782178217821782178217821782178"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM Expelled 43 / 4","amount":"1.706","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.042543640897755610972568579"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat, 12.3% prot","amount":"0.497","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.037089552238805970149253731343283582"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM Expelled 43 / 4","amount":"1.396","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.034812967581047381546134663"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM full fat","amount":"1.434","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.034721549636803874092009685"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM full fat","amount":"1.374","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.033268765133171912832929782"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat, 12.3% prot","amount":"0.424","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.031641791044776119402985074626865672"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat, 12.3% prot","amount":"0.384","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.028656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat, 12.3% prot","amount":"0.345","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.025746268656716417910447761194029851"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM full fat","amount":"1.053","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.0254963680387409200968523"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM Expelled 43 / 4","amount":"1.018","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.025386533665835411471321696"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler Start 75831","amount":"4.0","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.025"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Corn","amount":"0.323","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.020807716002656507630965501169498631088970401"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Corn","amount":"0.3","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.019326052014851245477676936070741762621334737"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat, 12.3% prot","amount":"0.258","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.019253731343283582089552238805970149"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM full fat","amount":"0.792","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.019176755447941888619854721549636804"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat, 12.3% prot","amount":"0.25","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.018656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Corn","amount":"0.285","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.018359749414108683203793089267204674490268"},{"nutrient_type_name":"Calcium","product_type_name":"Sunflower 34 Extracted","amount":"0.35","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.017326732673267326732673267326732673"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Sunflower 34 Extracted","amount":"0.304","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.015049504950495049504950495049504951"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Corn","amount":"0.225","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014494539011138434108257702053056321966001054"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Corn","amount":"0.223","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014365698664372759138406522479251376881858821"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Sunflower 34 Extracted","amount":"0.25","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.012376237623762376237623762376237624"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Corn","amount":"0.187","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.012046572422590609681085290150762365367298653"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM Expelled 43 / 4","amount":"0.476","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.011870324189526184538653366583541147"},{"nutrient_type_name":"Calcium","product_type_name":"Methionine","amount":"4.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.009876543209876543"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM full fat","amount":"0.398","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.009636803874092009685230024213075061"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat, 12.3% prot","amount":"0.123","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.009179104477611940298507462686567164"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Methionine","amount":"3.5","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.008641975308641975308641975"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat, 12.3% prot","amount":"0.1","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.007462686567164179104477611940298507"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Calcium","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat Mids","amount":"1619.0","weighted_avg_purchased_price":"9.6485013303836119","nutrient_value_per_unit_price":"0.0059595437494648622"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler Start 75831","amount":"0.88","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0055"},{"nutrient_type_name":"Calcium","product_type_name":"SBM full fat","amount":"0.22","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005326876513317191283292978208232446"},{"nutrient_type_name":"Fat","product_type_name":"Broiler Start 75831","amount":"0.83","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0051875"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Corn","amount":"0.08","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.005153613870626998794047182952197803365689263"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM full fat","amount":"0.21","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005084745762711864406779661016949153"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler Start 75831","amount":"0.81","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0050625"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler Start 75831","amount":"0.77","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0048125"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Barley","amount":"2714.0","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"0.00478997789240972734"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Corn","amount":"0.047","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.003027748148993361791502719984416209477342442"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat, 12.3% prot","amount":"0.04","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.002985074626865671641791044776119403"},{"nutrient_type_name":"Calcium","product_type_name":"Corn","amount":"0.04","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.002576806935313499397023591476098901682844632"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler grower 75832","amount":"1.2","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler finisher 75833","amount":"0.98","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler finisher 75833","amount":"32.2","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler grower 75832","amount":"32.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Broiler grower 75832","amount":"15.22","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.1","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler finisher 75833","amount":"0.78","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"Broiler grower 75832","amount":"0.74","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"Broiler finisher 75833","amount":"0.35","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.64","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"3.64","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler finisher 75833","amount":"2205.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler grower 75832","amount":"2168.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler grower 75832","amount":"8.35","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone pebbles","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone powder","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0}],"ration_products":[{"type":"Ingredients","name":"Limestone","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"2.6"},{"type":"Ingredients","name":"Soya oil","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"59.0"},{"type":"Ingredients","name":"Threonine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"205.0"},{"type":"Ingredients","name":"Methionine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"405.0"},{"type":"Ingredients","name":"Corn","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"15.523087683374898"},{"type":"Ingredients","name":"Wheat, 12.3% prot","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"13.4"},{"type":"Ingredients","name":"SBM full fat","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"41.3"},{"type":"Ingredients","name":"SBM Expelled 43 / 4","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"40.1"},{"type":"Ingredients","name":"Sunflower 34 Extracted","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"20.2"},{"type":"Ingredients","name":"Lysine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"200.0"},{"type":"Ingredients","name":"Mononcalcium Phosphate","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"67.0"},{"type":"Ingredients","name":"Broiler Start 75831","min":"1.5","max":"100.0","ingredient_cost_per_kilo":"160.0"}],"ration_nutrient_requirements":[{"name":"Dig. Isoleucine","min":"0.71","max":"100.0"},{"name":"Dig. Tryptophan","min":"0.18","max":"100.0"},{"name":"Crude Protein","min":"19.8","max":"100.0"},{"name":"Dig. Meth. + Cyst","min":"0.8","max":"100.0"},{"name":"Dig. Threonine","min":"0.69","max":"100.0"},{"name":"Energy ME Broiler","min":"2750.0","max":"3000.0"},{"name":"Dig. Valine","min":"0.85","max":"100.0"},{"name":"Dig. Lysine","min":"1.13","max":"100.0"},{"name":"Dig. Phosphorus Poultry","min":"0.4","max":"100.0"},{"name":"Calcium","min":"0.89","max":"100.0"},{"name":"Dig. Arganine","min":"1.15","max":"100.0"},{"name":"Crude Fiber","min":"0.0","max":"5.5"},{"name":"Fat","min":"0.0","max":"100.0"}]}

# B2: 22.18
# test_json = {"nutrient_chart":[{"nutrient_type_name":"Calcium","product_type_name":"Barley","amount":"0.05","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"260.0"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"170.25","nutrient_value_per_unit_price":"254.1044776119402985"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat, 12.3% prot","amount":"3035.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"226.492537313432835820895522389"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Barley","amount":"0.085","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"223.5294117647058824"},{"nutrient_type_name":"Crude Fiber","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"217.1641791044776119"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Corn","amount":"3310.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"213.230773897192075103702194647184114255"},{"nutrient_type_name":"Fat","product_type_name":"Broiler Start 75831","amount":"0.83","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"191.8072289156626506"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler finisher 75833","amount":"0.84","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"191.6666666666666667"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler Start 75831","amount":"0.88","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"180.9090909090909091"},{"nutrient_type_name":"Dig. Valine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.86","weighted_avg_purchased_price":"142.2091227243633938","nutrient_value_per_unit_price":"165.3594450283295277"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Soya oil","amount":"7500.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"127.118644067796610169"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Barley","amount":"0.12","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"108.3333333333333333"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Barley","amount":"0.222","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"85.5855855855855856"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat Mids","amount":"0.14","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"78.5714285714285714"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM full fat","amount":"3064.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"74.188861985472154963680387409"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler finisher 75833","amount":"2.2","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"73.1818181818181818"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Barley","amount":"0.273","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"69.5970695970695971"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat Mids","amount":"0.167","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"65.8682634730538922"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Sunflower 34 Extracted","amount":"1203.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"59.554455445544554455445544554"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM Expelled 43 / 4","amount":"2211.0","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"55.137157107231920199501246883"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Barley","amount":"0.244","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"53.2786885245901639"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Barley","amount":"0.216","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"48.6111111111111111"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler Start 75831","amount":"4.0","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"39.8"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat Mids","amount":"0.29","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"37.9310344827586207"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"4.83","weighted_avg_purchased_price":"179.7902752779305749","nutrient_value_per_unit_price":"37.2236594778324172"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler Start 75831","amount":"8.35","weighted_avg_purchased_price":"278.1081081081081081","nutrient_value_per_unit_price":"33.3063602524680369"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat Mids","amount":"0.343","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"32.0699708454810496"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat Mids","amount":"0.367","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"29.9727520435967302"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Barley","amount":"0.352","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"29.8295454545454545"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Barley","amount":"0.383","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"27.4151436031331593"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat Mids","amount":"0.426","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"25.8215962441314554"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat Mids","amount":"0.441","weighted_avg_purchased_price":"9.8","nutrient_value_per_unit_price":"22.2222222222222222"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler finisher 75833","amount":"6.5","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"21.3076923076923077"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler Start 75831","amount":"7.5","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"21.2266666666666667"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat Mids","amount":"0.539","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"20.4081632653061224"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler finisher 75833","amount":"8.35","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"19.281437125748503"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Lysine","amount":"3500.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"17.5"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler grower 75832","amount":"2168.0","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"16.059259259259259259"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"9.74","weighted_avg_purchased_price":"142.7041763482163898","nutrient_value_per_unit_price":"14.6513528078250914"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Threonine","amount":"3000.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"14.634146341463414634"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone","amount":"36.0","weighted_avg_purchased_price":"2.6","nutrient_value_per_unit_price":"13.846153846153846153846153847"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler Start 75831","amount":"12.0","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"13.2666666666666667"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"13.31","weighted_avg_purchased_price":"158.34038564270942819429168077128541885638855","nutrient_value_per_unit_price":"11.89634753138312758785061463345495258124632"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Methionine","amount":"4700.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"11.604938271604938272"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat Mids","amount":"0.871","weighted_avg_purchased_price":"9.92195994281566973","nutrient_value_per_unit_price":"11.39145802849101002"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler finisher 75833","amount":"15.05","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"10.6976744186046512"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler finisher 75833","amount":"15.4","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"10.4545454545454545"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler finisher 75833","amount":"14.5","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"9.5517241379310345"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler Start 75831","amount":"19.5","weighted_avg_purchased_price":"175.0","nutrient_value_per_unit_price":"8.9743589743589744"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"17.21","weighted_avg_purchased_price":"153.44581470995362142879621674116018551429076","nutrient_value_per_unit_price":"8.91608452701648003653667732371645470739633"},{"nutrient_type_name":"Fat","product_type_name":"Barley","amount":"2.0","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"5.25"},{"nutrient_type_name":"Crude Protein","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"29.4","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"4.9489795918367347"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler Start 75831","amount":"40.9","weighted_avg_purchased_price":"174.784688995215311","nutrient_value_per_unit_price":"4.2734642786116213"},{"nutrient_type_name":"Fat","product_type_name":"Wheat Mids","amount":"3.2","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"3.4375"},{"nutrient_type_name":"Fat","product_type_name":"Soya oil","amount":"100.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"1.694915254237288136"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Barley","amount":"6.2","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.6935483870967742"},{"nutrient_type_name":"Crude Protein","product_type_name":"Sunflower 34 Extracted","amount":"31.7","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.569306930693069306930693069"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Sunflower 34 Extracted","amount":"23.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.138613861386138613861386139"},{"nutrient_type_name":"Crude Protein","product_type_name":"Barley","amount":"9.5","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.1052631578947368"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM Expelled 43 / 4","amount":"43.1","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"1.074812967581047381546134663"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat Mids","amount":"11.0","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"1.0"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat, 12.3% prot","amount":"12.3","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.917910447761194029850746269"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM full fat","amount":"36.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.871670702179176755447941889"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat Mids","amount":"15.3","weighted_avg_purchased_price":"9.97054583725054306","nutrient_value_per_unit_price":"0.65166966256539497124"},{"nutrient_type_name":"Crude Protein","product_type_name":"Corn","amount":"7.8","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.502477352386132382419600337839285828"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Threonine","amount":"98.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.478048780487804878"},{"nutrient_type_name":"Crude Protein","product_type_name":"Lysine","amount":"95.6","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.478"},{"nutrient_type_name":"Fat","product_type_name":"SBM full fat","amount":"19.5","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.472154963680387409200968524"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Lysine","amount":"79.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.395"},{"nutrient_type_name":"Crude Protein","product_type_name":"Threonine","amount":"60.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.292682926829268293"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Mononcalcium Phosphate","amount":"19.29","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.287910447761194029850746269"},{"nutrient_type_name":"Calcium","product_type_name":"Mononcalcium Phosphate","amount":"18.0","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.268656716417910448"},{"nutrient_type_name":"Fat","product_type_name":"Corn","amount":"4.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.257680693531349939702359147609890168"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Methionine","amount":"99.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.244444444444444444"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler grower 75832","amount":"32.5","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.240740740740740740740740741"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat, 12.3% prot","amount":"3.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.223880597014925373134328358"},{"nutrient_type_name":"Fat","product_type_name":"SBM Expelled 43 / 4","amount":"6.2","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.154613466334164588528678304"},{"nutrient_type_name":"Crude Protein","product_type_name":"Methionine","amount":"58.7","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.144938271604938271604938272"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM Expelled 43 / 4","amount":"5.8","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.144638403990024937655860349"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM full fat","amount":"5.4","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.130750605326876513317191283"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Corn","amount":"2.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.128840346765674969851179573804945084"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler grower 75832","amount":"16.0","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.118518518518518519"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Sunflower 34 Extracted","amount":"2.337","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.115693069306930693069306931"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler grower 75832","amount":"15.22","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.112740740740740740740740741"},{"nutrient_type_name":"Fat","product_type_name":"Wheat, 12.3% prot","amount":"1.5","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.111940298507462686567164179"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler grower 75832","amount":"13.67","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.101259259259259259259259259"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"1800.0","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"0.08083333333333333333"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler Start 75831","amount":"2468.0","weighted_avg_purchased_price":"174.784688995215311","nutrient_value_per_unit_price":"0.07082037641621365924"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM Expelled 43 / 4","amount":"2.808","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.070024937655860349127182045"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Sunflower 34 Extracted","amount":"1.336","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.066138613861386138613861386"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler grower 75832","amount":"8.35","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.061851851851851851851851852"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM full fat","amount":"2.344","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.05675544794188861985472155"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Sunflower 34 Extracted","amount":"1.144","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.056633663366336633663366337"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM Expelled 43 / 4","amount":"2.262","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.056408977556109725685785536"},{"nutrient_type_name":"Fat","product_type_name":"Sunflower 34 Extracted","amount":"1.1","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.054455445544554455445544554"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Sunflower 34 Extracted","amount":"1.02","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.050495049504950495049504951"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler grower 75832","amount":"6.5","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.048148148148148148148148148"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Sunflower 34 Extracted","amount":"0.95","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.04702970297029702970297029702970297"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM Expelled 43 / 4","amount":"1.759","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.043865336658354114713216958"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM full fat","amount":"1.779","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.043075060532687651331719128"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Sunflower 34 Extracted","amount":"0.865","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.042821782178217821782178217821782178"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM Expelled 43 / 4","amount":"1.706","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.042543640897755610972568579"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat, 12.3% prot","amount":"0.497","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.037089552238805970149253731343283582"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM Expelled 43 / 4","amount":"1.396","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.034812967581047381546134663"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM full fat","amount":"1.434","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.034721549636803874092009685"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM full fat","amount":"1.374","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.033268765133171912832929782"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat, 12.3% prot","amount":"0.424","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.031641791044776119402985074626865672"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat, 12.3% prot","amount":"0.384","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.028656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat, 12.3% prot","amount":"0.345","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.025746268656716417910447761194029851"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM full fat","amount":"1.053","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.0254963680387409200968523"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM Expelled 43 / 4","amount":"1.018","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.025386533665835411471321696"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Corn","amount":"0.323","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.020807716002656507630965501169498631088970401"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Corn","amount":"0.3","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.019326052014851245477676936070741762621334737"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat, 12.3% prot","amount":"0.258","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.019253731343283582089552238805970149"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM full fat","amount":"0.792","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.019176755447941888619854721549636804"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat, 12.3% prot","amount":"0.25","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.018656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Corn","amount":"0.285","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.018359749414108683203793089267204674490268"},{"nutrient_type_name":"Calcium","product_type_name":"Sunflower 34 Extracted","amount":"0.35","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.017326732673267326732673267326732673"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler grower 75832","amount":"2.2","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.016296296296296296296296296"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Sunflower 34 Extracted","amount":"0.304","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.015049504950495049504950495049504951"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Corn","amount":"0.225","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014494539011138434108257702053056321966001054"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Corn","amount":"0.223","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014365698664372759138406522479251376881858821"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Sunflower 34 Extracted","amount":"0.25","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.012376237623762376237623762376237624"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Corn","amount":"0.187","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.012046572422590609681085290150762365367298653"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM Expelled 43 / 4","amount":"0.476","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.011870324189526184538653366583541147"},{"nutrient_type_name":"Calcium","product_type_name":"Methionine","amount":"4.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.009876543209876543"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM full fat","amount":"0.398","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.009636803874092009685230024213075061"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat, 12.3% prot","amount":"0.123","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.009179104477611940298507462686567164"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler grower 75832","amount":"1.2","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.008888888888888888888888889"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Methionine","amount":"3.5","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.008641975308641975308641975"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat, 12.3% prot","amount":"0.1","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.007462686567164179104477611940298507"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Calcium","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler grower 75832","amount":"0.82","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.006074074074074074074074074"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat Mids","amount":"1619.0","weighted_avg_purchased_price":"9.6485013303836119","nutrient_value_per_unit_price":"0.0059595437494648622"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler grower 75832","amount":"0.77","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.005703703703703703703703704"},{"nutrient_type_name":"Fat","product_type_name":"Broiler grower 75832","amount":"0.74","weighted_avg_purchased_price":"135.0","nutrient_value_per_unit_price":"0.005481481481481481481481481"},{"nutrient_type_name":"Calcium","product_type_name":"SBM full fat","amount":"0.22","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005326876513317191283292978208232446"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Corn","amount":"0.08","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.005153613870626998794047182952197803365689263"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM full fat","amount":"0.21","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005084745762711864406779661016949153"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Barley","amount":"2714.0","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"0.00478997789240972734"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Corn","amount":"0.047","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.003027748148993361791502719984416209477342442"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat, 12.3% prot","amount":"0.04","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.002985074626865671641791044776119403"},{"nutrient_type_name":"Calcium","product_type_name":"Corn","amount":"0.04","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.002576806935313499397023591476098901682844632"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler finisher 75833","amount":"32.2","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone pebbles","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.64","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler Start 75831","amount":"17.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler finisher 75833","amount":"0.98","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler finisher 75833","amount":"2205.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.1","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler finisher 75833","amount":"0.78","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"3.64","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler Start 75831","amount":"0.81","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"Broiler finisher 75833","amount":"0.35","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler Start 75831","amount":"0.77","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone powder","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0}],"ration_products":[{"type":"Ingredients","name":"Soya oil","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"59.0"},{"type":"Ingredients","name":"Threonine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"205.0"},{"type":"Ingredients","name":"Broiler grower 75832","min":"1.7","max":"100.0","ingredient_cost_per_kilo":"135.0"},{"type":"Ingredients","name":"Limestone","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"2.6"},{"type":"Ingredients","name":"Mononcalcium Phosphate","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"67.0"},{"type":"Ingredients","name":"Sunflower 34 Extracted","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"20.2"},{"type":"Ingredients","name":"SBM Expelled 43 / 4","min":"0.0","max":"16.0","ingredient_cost_per_kilo":"40.1"},{"type":"Ingredients","name":"SBM full fat","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"41.3"},{"type":"Ingredients","name":"Wheat, 12.3% prot","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"13.4"},{"type":"Ingredients","name":"Corn","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"15.523087683374898"},{"type":"Ingredients","name":"Lysine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"200.0"},{"type":"Ingredients","name":"Methionine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"405.0"}],"ration_nutrient_requirements":[{"name":"Dig. Tryptophan","min":"0.17","max":"100.0"},{"name":"Fat","min":"0.0","max":"100.0"},{"name":"Dig. Lysine","min":"0.98","max":"100.0"},{"name":"Dig. Meth. + Cyst","min":"0.72","max":"100.0"},{"name":"Dig. Isoleucine","min":"0.63","max":"100.0"},{"name":"Dig. Threonine","min":"0.62","max":"100.0"},{"name":"Dig. Valine","min":"0.75","max":"100.0"},{"name":"Dig. Phosphorus Poultry","min":"0.29","max":"100.0"},{"name":"Energy ME Broiler","min":"2875.0","max":"3100.0"},{"name":"Calcium","min":"0.6","max":"100.0"},{"name":"Crude Fiber","min":"0.0","max":"5.5"},{"name":"Dig. Arganine","min":"1.02","max":"100.0"},{"name":"Crude Protein","min":"19.4","max":"100.0"}]}

# B3: 23.15 
# test_json = {"nutrient_chart":[{"nutrient_type_name":"Calcium","product_type_name":"Barley","amount":"0.05","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"260.0"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"170.25","nutrient_value_per_unit_price":"254.1044776119402985"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat, 12.3% prot","amount":"3035.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"226.492537313432835820895522389"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Barley","amount":"0.085","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"223.5294117647058824"},{"nutrient_type_name":"Crude Fiber","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"217.1641791044776119"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler grower 75832","amount":"0.82","weighted_avg_purchased_price":"175.0","nutrient_value_per_unit_price":"213.4146341463414634"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Corn","amount":"3310.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"213.230773897192075103702194647184114255"},{"nutrient_type_name":"Fat","product_type_name":"Broiler Start 75831","amount":"0.83","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"191.8072289156626506"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler Start 75831","amount":"0.88","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"180.9090909090909091"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler grower 75832","amount":"0.77","weighted_avg_purchased_price":"133.5","nutrient_value_per_unit_price":"173.3766233766233766"},{"nutrient_type_name":"Dig. Valine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.86","weighted_avg_purchased_price":"142.2091227243633938","nutrient_value_per_unit_price":"165.3594450283295277"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Soya oil","amount":"7500.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"127.118644067796610169"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Barley","amount":"0.12","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"108.3333333333333333"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Barley","amount":"0.222","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"85.5855855855855856"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Sunflower 34 Extracted","amount":"0.25","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"82.0"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat Mids","amount":"0.14","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"78.5714285714285714"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM full fat","amount":"3064.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"74.188861985472154963680387409"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler grower 75832","amount":"2.2","weighted_avg_purchased_price":"156.0","nutrient_value_per_unit_price":"70.9090909090909091"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Barley","amount":"0.273","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"69.5970695970695971"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Sunflower 34 Extracted","amount":"0.304","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"67.4342105263157895"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat Mids","amount":"0.167","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"65.8682634730538922"},{"nutrient_type_name":"Calcium","product_type_name":"Sunflower 34 Extracted","amount":"0.35","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"58.5714285714285714"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM Expelled 43 / 4","amount":"2211.0","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"55.137157107231920199501246883"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Barley","amount":"0.244","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"53.2786885245901639"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Barley","amount":"0.216","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"48.6111111111111111"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler Start 75831","amount":"4.0","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"39.8"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat Mids","amount":"0.29","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"37.9310344827586207"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"4.83","weighted_avg_purchased_price":"179.7902752779305749","nutrient_value_per_unit_price":"37.2236594778324172"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler grower 75832","amount":"6.5","weighted_avg_purchased_price":"240.1272727272727273","nutrient_value_per_unit_price":"36.9426573426573427"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler Start 75831","amount":"8.35","weighted_avg_purchased_price":"278.1081081081081081","nutrient_value_per_unit_price":"33.3063602524680369"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat Mids","amount":"0.343","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"32.0699708454810496"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat Mids","amount":"0.367","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"29.9727520435967302"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Barley","amount":"0.352","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"29.8295454545454545"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Barley","amount":"0.383","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"27.4151436031331593"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat Mids","amount":"0.426","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"25.8215962441314554"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Sunflower 34 Extracted","amount":"0.865","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"23.6994219653179191"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat Mids","amount":"0.441","weighted_avg_purchased_price":"9.8","nutrient_value_per_unit_price":"22.2222222222222222"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Sunflower 34 Extracted","amount":"0.95","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"21.5789473684210526"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler Start 75831","amount":"7.5","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"21.2266666666666667"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat Mids","amount":"0.539","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"20.4081632653061224"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Sunflower 34 Extracted","amount":"1.02","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"20.0980392156862745"},{"nutrient_type_name":"Fat","product_type_name":"Sunflower 34 Extracted","amount":"1.1","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"18.6363636363636364"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Sunflower 34 Extracted","amount":"1.144","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"17.9195804195804196"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Lysine","amount":"3500.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"17.5"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler finisher 75833","amount":"2205.0","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"15.75"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Sunflower 34 Extracted","amount":"1.336","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"15.344311377245509"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"9.74","weighted_avg_purchased_price":"142.7041763482163898","nutrient_value_per_unit_price":"14.6513528078250914"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Threonine","amount":"3000.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"14.634146341463414634"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone","amount":"36.0","weighted_avg_purchased_price":"2.6","nutrient_value_per_unit_price":"13.846153846153846153846153847"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler Start 75831","amount":"12.0","weighted_avg_purchased_price":"159.2","nutrient_value_per_unit_price":"13.2666666666666667"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"13.31","weighted_avg_purchased_price":"158.34038564270942819429168077128541885638855","nutrient_value_per_unit_price":"11.89634753138312758785061463345495258124632"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Methionine","amount":"4700.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"11.604938271604938272"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat Mids","amount":"0.871","weighted_avg_purchased_price":"9.92195994281566973","nutrient_value_per_unit_price":"11.39145802849101002"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Sunflower 34 Extracted","amount":"2.337","weighted_avg_purchased_price":"25.092874029","nutrient_value_per_unit_price":"10.7372161014120668"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler grower 75832","amount":"13.67","weighted_avg_purchased_price":"133.5","nutrient_value_per_unit_price":"9.7659107534747623"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler grower 75832","amount":"16.0","weighted_avg_purchased_price":"156.0","nutrient_value_per_unit_price":"9.75"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler Start 75831","amount":"19.5","weighted_avg_purchased_price":"175.0","nutrient_value_per_unit_price":"8.9743589743589744"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"17.21","weighted_avg_purchased_price":"153.44581470995362142879621674116018551429076","nutrient_value_per_unit_price":"8.91608452701648003653667732371645470739633"},{"nutrient_type_name":"Fat","product_type_name":"Barley","amount":"2.0","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"5.25"},{"nutrient_type_name":"Crude Protein","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"29.4","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"4.9489795918367347"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler Start 75831","amount":"40.9","weighted_avg_purchased_price":"174.784688995215311","nutrient_value_per_unit_price":"4.2734642786116213"},{"nutrient_type_name":"Fat","product_type_name":"Wheat Mids","amount":"3.2","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"3.4375"},{"nutrient_type_name":"Fat","product_type_name":"Soya oil","amount":"100.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"1.694915254237288136"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Barley","amount":"6.2","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.6935483870967742"},{"nutrient_type_name":"Crude Protein","product_type_name":"Barley","amount":"9.5","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.1052631578947368"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM Expelled 43 / 4","amount":"43.1","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"1.074812967581047381546134663"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat Mids","amount":"11.0","weighted_avg_purchased_price":"11.0","nutrient_value_per_unit_price":"1.0"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat, 12.3% prot","amount":"12.3","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.917910447761194029850746269"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Sunflower 34 Extracted","amount":"23.0","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"0.89130434782608695652"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM full fat","amount":"36.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.871670702179176755447941889"},{"nutrient_type_name":"Crude Protein","product_type_name":"Sunflower 34 Extracted","amount":"31.7","weighted_avg_purchased_price":"22.0","nutrient_value_per_unit_price":"0.69400630914826498423"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat Mids","amount":"15.3","weighted_avg_purchased_price":"9.97054583725054306","nutrient_value_per_unit_price":"0.65166966256539497124"},{"nutrient_type_name":"Crude Protein","product_type_name":"Corn","amount":"7.8","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.502477352386132382419600337839285828"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Threonine","amount":"98.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.478048780487804878"},{"nutrient_type_name":"Crude Protein","product_type_name":"Lysine","amount":"95.6","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.478"},{"nutrient_type_name":"Fat","product_type_name":"SBM full fat","amount":"19.5","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.472154963680387409200968524"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Lysine","amount":"79.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.395"},{"nutrient_type_name":"Crude Protein","product_type_name":"Threonine","amount":"60.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.292682926829268293"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Mononcalcium Phosphate","amount":"19.29","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.287910447761194029850746269"},{"nutrient_type_name":"Calcium","product_type_name":"Mononcalcium Phosphate","amount":"18.0","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.268656716417910448"},{"nutrient_type_name":"Fat","product_type_name":"Corn","amount":"4.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.257680693531349939702359147609890168"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Methionine","amount":"99.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.244444444444444444"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler finisher 75833","amount":"32.2","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.23"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat, 12.3% prot","amount":"3.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.223880597014925373134328358"},{"nutrient_type_name":"Fat","product_type_name":"SBM Expelled 43 / 4","amount":"6.2","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.154613466334164588528678304"},{"nutrient_type_name":"Crude Protein","product_type_name":"Methionine","amount":"58.7","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.144938271604938271604938272"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM Expelled 43 / 4","amount":"5.8","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.144638403990024937655860349"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM full fat","amount":"5.4","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.130750605326876513317191283"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Corn","amount":"2.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.128840346765674969851179573804945084"},{"nutrient_type_name":"Fat","product_type_name":"Wheat, 12.3% prot","amount":"1.5","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.111940298507462686567164179"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler finisher 75833","amount":"15.4","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.11"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler finisher 75833","amount":"15.05","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.1075"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler finisher 75833","amount":"14.5","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.103571428571428571428571429"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"1800.0","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"0.08083333333333333333"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler Start 75831","amount":"2468.0","weighted_avg_purchased_price":"174.784688995215311","nutrient_value_per_unit_price":"0.07082037641621365924"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM Expelled 43 / 4","amount":"2.808","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.070024937655860349127182045"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler finisher 75833","amount":"8.35","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.059642857142857142857142857"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"SBM full fat","amount":"2.344","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.05675544794188861985472155"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM Expelled 43 / 4","amount":"2.262","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.056408977556109725685785536"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler finisher 75833","amount":"6.5","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.046428571428571428571428571"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM Expelled 43 / 4","amount":"1.759","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.043865336658354114713216958"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM full fat","amount":"1.779","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.043075060532687651331719128"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM Expelled 43 / 4","amount":"1.706","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.042543640897755610972568579"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Wheat, 12.3% prot","amount":"0.497","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.037089552238805970149253731343283582"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM Expelled 43 / 4","amount":"1.396","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.034812967581047381546134663"},{"nutrient_type_name":"Dig. Valine","product_type_name":"SBM full fat","amount":"1.434","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.034721549636803874092009685"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"SBM full fat","amount":"1.374","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.033268765133171912832929782"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Wheat, 12.3% prot","amount":"0.424","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.031641791044776119402985074626865672"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat, 12.3% prot","amount":"0.384","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.028656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Wheat, 12.3% prot","amount":"0.345","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.025746268656716417910447761194029851"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM full fat","amount":"1.053","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.0254963680387409200968523"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM Expelled 43 / 4","amount":"1.018","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.025386533665835411471321696"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Corn","amount":"0.323","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.020807716002656507630965501169498631088970401"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Corn","amount":"0.3","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.019326052014851245477676936070741762621334737"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat, 12.3% prot","amount":"0.258","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.019253731343283582089552238805970149"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM full fat","amount":"0.792","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.019176755447941888619854721549636804"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat, 12.3% prot","amount":"0.25","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.018656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Corn","amount":"0.285","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.018359749414108683203793089267204674490268"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Sunflower 34 Extracted","amount":"1203.0","weighted_avg_purchased_price":"20.5","nutrient_value_per_unit_price":"0.01704073150457190357"},{"nutrient_type_name":"Dig. Valine","product_type_name":"Broiler finisher 75833","amount":"2.2","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.015714285714285714285714286"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Corn","amount":"0.225","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014494539011138434108257702053056321966001054"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Corn","amount":"0.223","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014365698664372759138406522479251376881858821"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Corn","amount":"0.187","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.012046572422590609681085290150762365367298653"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM Expelled 43 / 4","amount":"0.476","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.011870324189526184538653366583541147"},{"nutrient_type_name":"Calcium","product_type_name":"Methionine","amount":"4.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.009876543209876543"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"SBM full fat","amount":"0.398","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.009636803874092009685230024213075061"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Wheat, 12.3% prot","amount":"0.123","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.009179104477611940298507462686567164"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Methionine","amount":"3.5","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.008641975308641975308641975"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat, 12.3% prot","amount":"0.1","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.007462686567164179104477611940298507"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler finisher 75833","amount":"0.98","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.007"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Calcium","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler finisher 75833","amount":"0.84","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.006"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat Mids","amount":"1619.0","weighted_avg_purchased_price":"9.6485013303836119","nutrient_value_per_unit_price":"0.0059595437494648622"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler finisher 75833","amount":"0.78","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.005571428571428571428571429"},{"nutrient_type_name":"Calcium","product_type_name":"SBM full fat","amount":"0.22","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005326876513317191283292978208232446"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Corn","amount":"0.08","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.005153613870626998794047182952197803365689263"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM full fat","amount":"0.21","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005084745762711864406779661016949153"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Barley","amount":"2714.0","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"0.00478997789240972734"},{"nutrient_type_name":"Dig. Tryptophan","product_type_name":"Corn","amount":"0.047","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.003027748148993361791502719984416209477342442"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat, 12.3% prot","amount":"0.04","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.002985074626865671641791044776119403"},{"nutrient_type_name":"Calcium","product_type_name":"Corn","amount":"0.04","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.002576806935313499397023591476098901682844632"},{"nutrient_type_name":"Fat","product_type_name":"Broiler finisher 75833","amount":"0.35","weighted_avg_purchased_price":"140.0","nutrient_value_per_unit_price":"0.0025"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler grower 75832","amount":"8.35","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler grower 75832","amount":"2168.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.64","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler Start 75831","amount":"17.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"3.64","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Isoleucine","product_type_name":"Broiler Start 75831","amount":"0.77","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Broiler grower 75832","amount":"15.22","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.1","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone powder","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Arganine","product_type_name":"Broiler Start 75831","amount":"0.81","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler grower 75832","amount":"1.2","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"Broiler grower 75832","amount":"0.74","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler grower 75832","amount":"32.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone pebbles","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0}],"ration_products":[{"type":"Ingredients","name":"Threonine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"205.0"},{"type":"Ingredients","name":"Lysine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"200.0"},{"type":"Ingredients","name":"SBM full fat","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"41.3"},{"type":"Ingredients","name":"Broiler finisher 75833","min":"1.5","max":"100.0","ingredient_cost_per_kilo":"140.0"},{"type":"Ingredients","name":"Limestone","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"2.6"},{"type":"Ingredients","name":"Mononcalcium Phosphate","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"67.0"},{"type":"Ingredients","name":"Soya oil","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"59.0"},{"type":"Ingredients","name":"Wheat, 12.3% prot","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"13.4"},{"type":"Ingredients","name":"SBM Expelled 43 / 4","min":"0.0","max":"1.0","ingredient_cost_per_kilo":"40.1"},{"type":"Ingredients","name":"Methionine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"405.0"},{"type":"Ingredients","name":"Corn","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"15.523087683374898"}],"ration_nutrient_requirements":[{"name":"Dig. Arganine","min":"0.99","max":"100.0"},{"name":"Crude Protein","min":"19.0","max":"100.0"},{"name":"Dig. Phosphorus Poultry","min":"0.27","max":"100.0"},{"name":"Dig. Meth. + Cyst","min":"0.71","max":"100.0"},{"name":"Dig. Valine","min":"0.73","max":"100.0"},{"name":"Dig. Isoleucine","min":"0.62","max":"100.0"},{"name":"Energy ME Broiler","min":"3000.0","max":"3100.0"},{"name":"Dig. Threonine","min":"0.6","max":"100.0"},{"name":"Dig. Lysine","min":"0.94","max":"100.0"},{"name":"Fat","min":"0.0","max":"100.0"},{"name":"Calcium","min":"0.56","max":"100.0"},{"name":"Dig. Tryptophan","min":"0.17","max":"100.0"},{"name":"Crude Fiber","min":"0.0","max":"5.5"}]}

# J1 20.25
# test_json = {"nutrient_chart":[{"nutrient_type_name":"Fat","product_type_name":"Broiler finisher 75833","amount":"0.35","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"395.7142857142857143"},{"nutrient_type_name":"Calcium","product_type_name":"Barley","amount":"0.05","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"260.0"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat, 12.3% prot","amount":"3035.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"226.492537313432835820895522389"},{"nutrient_type_name":"Crude Fiber","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.67","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"217.1641791044776119"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Corn","amount":"3310.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"213.230773897192075103702194647184114255"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Wheat Mids","amount":"1619.0","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"179.888888888888888889"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler finisher 75833","amount":"0.98","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"164.2857142857142857"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler grower 75832","amount":"1.2","weighted_avg_purchased_price":"156.0","nutrient_value_per_unit_price":"130.0"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Soya oil","amount":"7500.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"127.118644067796610169"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Barley","amount":"0.12","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"108.3333333333333333"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Barley","amount":"0.216","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"87.962962962962963"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM full fat","amount":"3064.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"74.188861985472154963680387409"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Sunflower 34 Extracted","amount":"1203.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"59.554455445544554455445544554"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"SBM Expelled 43 / 4","amount":"2211.0","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"55.137157107231920199501246883"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Barley","amount":"0.273","weighted_avg_purchased_price":"13.0","nutrient_value_per_unit_price":"47.619047619047619"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Barley","amount":"0.222","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"47.2972972972972973"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"4.83","weighted_avg_purchased_price":"145.5","nutrient_value_per_unit_price":"30.124223602484472"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler grower 75832","amount":"8.35","weighted_avg_purchased_price":"186.3714285714285714","nutrient_value_per_unit_price":"22.3199315654405475"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler finisher 75833","amount":"6.5","weighted_avg_purchased_price":"142.2","nutrient_value_per_unit_price":"21.8769230769230769"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Lysine","amount":"3500.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"17.5"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler finisher 75833","amount":"8.35","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"16.5868263473053892"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler Start 75831","amount":"2468.0","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"15.425"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Threonine","amount":"3000.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"14.634146341463414634"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone powder","amount":"36.0","weighted_avg_purchased_price":"2.6","nutrient_value_per_unit_price":"13.846153846153846153846153847"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"13.31","weighted_avg_purchased_price":"170.25","nutrient_value_per_unit_price":"12.7911344853493614"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Methionine","amount":"4700.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"11.604938271604938272"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler finisher 75833","amount":"15.05","weighted_avg_purchased_price":"161.0","nutrient_value_per_unit_price":"10.6976744186046512"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler grower 75832","amount":"13.67","weighted_avg_purchased_price":"133.5","nutrient_value_per_unit_price":"9.7659107534747623"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler finisher 75833","amount":"15.4","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"8.9935064935064935"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"17.21","weighted_avg_purchased_price":"149.19604492265883049","nutrient_value_per_unit_price":"8.66914845570359271"},{"nutrient_type_name":"Fat","product_type_name":"Barley","amount":"2.0","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"5.25"},{"nutrient_type_name":"Crude Protein","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"29.4","weighted_avg_purchased_price":"142.0766791984605036","nutrient_value_per_unit_price":"4.8325401087911736"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler finisher 75833","amount":"32.2","weighted_avg_purchased_price":"138.5","nutrient_value_per_unit_price":"4.3012422360248447"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Barley","amount":"6.2","weighted_avg_purchased_price":"19.0","nutrient_value_per_unit_price":"3.0645161290322581"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat Mids","amount":"15.3","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"1.7"},{"nutrient_type_name":"Fat","product_type_name":"Soya oil","amount":"100.0","weighted_avg_purchased_price":"59.0","nutrient_value_per_unit_price":"1.694915254237288136"},{"nutrient_type_name":"Crude Protein","product_type_name":"Sunflower 34 Extracted","amount":"31.7","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.569306930693069306930693069"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat Mids","amount":"11.0","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"1.222222222222222222"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Sunflower 34 Extracted","amount":"23.0","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"1.138613861386138613861386139"},{"nutrient_type_name":"Crude Protein","product_type_name":"Barley","amount":"9.5","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"1.1052631578947368"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM Expelled 43 / 4","amount":"43.1","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"1.074812967581047381546134663"},{"nutrient_type_name":"Crude Protein","product_type_name":"Wheat, 12.3% prot","amount":"12.3","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.917910447761194029850746269"},{"nutrient_type_name":"Crude Protein","product_type_name":"SBM full fat","amount":"36.0","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.871670702179176755447941889"},{"nutrient_type_name":"Crude Protein","product_type_name":"Corn","amount":"7.8","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.502477352386132382419600337839285828"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Threonine","amount":"98.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.478048780487804878"},{"nutrient_type_name":"Crude Protein","product_type_name":"Lysine","amount":"95.6","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.478"},{"nutrient_type_name":"Fat","product_type_name":"SBM full fat","amount":"19.5","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.472154963680387409200968524"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Lysine","amount":"79.0","weighted_avg_purchased_price":"200.0","nutrient_value_per_unit_price":"0.395"},{"nutrient_type_name":"Fat","product_type_name":"Wheat Mids","amount":"3.2","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.355555555555555555555555556"},{"nutrient_type_name":"Crude Protein","product_type_name":"Threonine","amount":"60.0","weighted_avg_purchased_price":"205.0","nutrient_value_per_unit_price":"0.292682926829268293"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Mononcalcium Phosphate","amount":"19.29","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.287910447761194029850746269"},{"nutrient_type_name":"Calcium","product_type_name":"Mononcalcium Phosphate","amount":"18.0","weighted_avg_purchased_price":"67.0","nutrient_value_per_unit_price":"0.268656716417910448"},{"nutrient_type_name":"Fat","product_type_name":"Corn","amount":"4.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.257680693531349939702359147609890168"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler Start 75831","amount":"40.9","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.255625"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Methionine","amount":"99.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.244444444444444444"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Wheat, 12.3% prot","amount":"3.0","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.223880597014925373134328358"},{"nutrient_type_name":"Fat","product_type_name":"SBM Expelled 43 / 4","amount":"6.2","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.154613466334164588528678304"},{"nutrient_type_name":"Crude Protein","product_type_name":"Methionine","amount":"58.7","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.144938271604938271604938272"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM Expelled 43 / 4","amount":"5.8","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.144638403990024937655860349"},{"nutrient_type_name":"Crude Fiber","product_type_name":"SBM full fat","amount":"5.4","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.130750605326876513317191283"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Corn","amount":"2.0","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.128840346765674969851179573804945084"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler Start 75831","amount":"19.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.121875"},{"nutrient_type_name":"Fat","product_type_name":"Wheat, 12.3% prot","amount":"1.5","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.111940298507462686567164179"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler Start 75831","amount":"17.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.109375"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"1800.0","weighted_avg_purchased_price":"158.34038564270942819429168077128541885638855","nutrient_value_per_unit_price":"0.08796688091261634899682871153960301047577"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler grower 75832","amount":"2168.0","weighted_avg_purchased_price":"175.0","nutrient_value_per_unit_price":"0.08071955719557195572"},{"nutrient_type_name":"Calcium","product_type_name":"Broiler Start 75831","amount":"12.0","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.075"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM Expelled 43 / 4","amount":"2.262","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.056408977556109725685785536"},{"nutrient_type_name":"Fat","product_type_name":"Sunflower 34 Extracted","amount":"1.1","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.054455445544554455445544554"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Broiler Start 75831","amount":"8.35","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0521875"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Sunflower 34 Extracted","amount":"1.02","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.050495049504950495049504951"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat Mids","amount":"0.441","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.049"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat Mids","amount":"0.426","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.047333333333333333333333333"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Sunflower 34 Extracted","amount":"0.95","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.04702970297029702970297029702970297"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler Start 75831","amount":"7.5","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.046875"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"SBM full fat","amount":"1.779","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.043075060532687651331719128"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Sunflower 34 Extracted","amount":"0.865","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.042821782178217821782178217821782178"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat Mids","amount":"0.343","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.038111111111111111111111111"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM Expelled 43 / 4","amount":"1.396","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.034812967581047381546134663"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat Mids","amount":"0.29","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.032222222222222222222222222"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Wheat, 12.3% prot","amount":"0.384","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.028656716417910447761194029850746269"},{"nutrient_type_name":"Calcium","product_type_name":"Limestone","amount":"36.0","weighted_avg_purchased_price":"1.0","nutrient_value_per_unit_price":"0.02777777777777777778"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"SBM full fat","amount":"1.053","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.0254963680387409200968523"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM Expelled 43 / 4","amount":"1.018","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.025386533665835411471321696"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Wheat, 12.3% prot","amount":"0.258","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.019253731343283582089552238805970149"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"SBM full fat","amount":"0.792","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.019176755447941888619854721549636804"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Wheat, 12.3% prot","amount":"0.25","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.018656716417910447761194029850746269"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Corn","amount":"0.285","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.018359749414108683203793089267204674490268"},{"nutrient_type_name":"Calcium","product_type_name":"Sunflower 34 Extracted","amount":"0.35","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.017326732673267326732673267326732673"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat Mids","amount":"0.14","weighted_avg_purchased_price":"9.0","nutrient_value_per_unit_price":"0.015555555555555555555555556"},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Corn","amount":"0.225","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.014494539011138434108257702053056321966001054"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Sunflower 34 Extracted","amount":"0.25","weighted_avg_purchased_price":"20.2","nutrient_value_per_unit_price":"0.012376237623762376237623762376237624"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Corn","amount":"0.187","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.012046572422590609681085290150762365367298653"},{"nutrient_type_name":"Calcium","product_type_name":"Methionine","amount":"4.0","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.009876543209876543"},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Methionine","amount":"3.5","weighted_avg_purchased_price":"405.0","nutrient_value_per_unit_price":"0.008641975308641975308641975"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Wheat, 12.3% prot","amount":"0.1","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.007462686567164179104477611940298507"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Calcium","product_type_name":"SBM Expelled 43 / 4","amount":"0.27","weighted_avg_purchased_price":"40.1","nutrient_value_per_unit_price":"0.00673316708229426433915211970074813"},{"nutrient_type_name":"Crude Fiber","product_type_name":"Broiler Start 75831","amount":"0.88","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0055"},{"nutrient_type_name":"Calcium","product_type_name":"SBM full fat","amount":"0.22","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005326876513317191283292978208232446"},{"nutrient_type_name":"Fat","product_type_name":"Broiler Start 75831","amount":"0.83","weighted_avg_purchased_price":"160.0","nutrient_value_per_unit_price":"0.0051875"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"Corn","amount":"0.08","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.005153613870626998794047182952197803365689263"},{"nutrient_type_name":"Dig. Phosphorus Poultry","product_type_name":"SBM full fat","amount":"0.21","weighted_avg_purchased_price":"41.3","nutrient_value_per_unit_price":"0.005084745762711864406779661016949153"},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Barley","amount":"2714.0","weighted_avg_purchased_price":"10.5","nutrient_value_per_unit_price":"0.00386882829771554901"},{"nutrient_type_name":"Calcium","product_type_name":"Wheat, 12.3% prot","amount":"0.04","weighted_avg_purchased_price":"13.4","nutrient_value_per_unit_price":"0.002985074626865671641791044776119403"},{"nutrient_type_name":"Calcium","product_type_name":"Corn","amount":"0.04","weighted_avg_purchased_price":"15.523087683374898","nutrient_value_per_unit_price":"0.002576806935313499397023591476098901682844632"},{"nutrient_type_name":"Fat","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"0.1","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Crude Protein","product_type_name":"Broiler grower 75832","amount":"32.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Fat","product_type_name":"Broiler grower 75832","amount":"0.74","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"3.64","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"KLP 9449 1% (layer) Roche 12","amount":"9.74","weighted_avg_purchased_price":"0.0","nutrient_value_per_unit_price":"0.0"},{"nutrient_type_name":"Dig. Meth. + Cyst","product_type_name":"Broiler finisher 75833","amount":"14.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Energy ME Broiler","product_type_name":"Broiler finisher 75833","amount":"2205.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Broiler grower 75832","amount":"15.22","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Calcium","product_type_name":"Limestone pebbles","amount":"36.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Threonine","product_type_name":"Broiler grower 75832","amount":"6.5","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0},{"nutrient_type_name":"Dig. Lysine","product_type_name":"Broiler grower 75832","amount":"16.0","weighted_avg_purchased_price":0,"nutrient_value_per_unit_price":0}],"ration_products":[{"type":"Ingredients","name":"Wheat Mids","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"9.0"},{"type":"Ingredients","name":"product_41","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"82.88"},{"type":"Ingredients","name":"Broiler Start 75831","min":"1.3","max":"100.0","ingredient_cost_per_kilo":"160.0"},{"type":"Ingredients","name":"Limestone powder","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"2.6"},{"type":"Ingredients","name":"Mononcalcium Phosphate","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"67.0"},{"type":"Ingredients","name":"Lysine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"200.0"},{"type":"Ingredients","name":"Sunflower 34 Extracted","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"20.2"},{"type":"Ingredients","name":"SBM Expelled 43 / 4","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"40.1"},{"type":"Ingredients","name":"SBM full fat","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"41.3"},{"type":"Ingredients","name":"Wheat, 12.3% prot","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"13.4"},{"type":"Ingredients","name":"Corn","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"15.523087683374898"},{"type":"Ingredients","name":"Lysine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"200.0"},{"type":"Ingredients","name":"Methionine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"405.0"},{"type":"Ingredients","name":"Threonine","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"205.0"},{"type":"Ingredients","name":"Soya oil","min":"0.0","max":"100.0","ingredient_cost_per_kilo":"59.0"}],"ration_nutrient_requirements":[{"name":"Energy ME Broiler","min":"2600.0","max":"3000.0"},{"name":"Crude Protein","min":"19.0","max":"100.0"},{"name":"Calcium","min":"1.0","max":"1.1"},{"name":"Dig. Lysine","min":"0.85","max":"100.0"},{"name":"Dig. Meth. + Cyst","min":"0.65","max":"100.0"},{"name":"Dig. Threonine","min":"0.48","max":"100.0"},{"name":"Dig. Phosphorus Poultry","min":"0.36","max":"100.0"},{"name":"Fat","min":"0.0","max":"100.0"},{"name":"Crude Fiber","min":"0.0","max":"5.5"}]}

send_to_ruby = False

def load_nutrients_and_ingredients(json):
    
    for i, nut_req in enumerate(json['ration_nutrient_requirements']):
        nutrients[nut_req['name']] = Nutrient(nut_req['name'], float(nut_req['min']), float(nut_req['max']))
    
    ing_nutrients = {}
    for i, row in enumerate(json['nutrient_chart']):

        if row['product_type_name'] not in ing_nutrients:
            ing_nutrients[row['product_type_name']] = []

        ing_nutrients[row['product_type_name']].append((row['nutrient_type_name'], float(row['amount'])))

    for i, ing in enumerate(json['ration_products']):

        nuts = []
        if ing['name'] in ing_nutrients:
            nuts = ing_nutrients[ing['name']]
        ingredients.append(Ingredient(ing['name'], float(ing['ingredient_cost_per_kilo']), nuts, minimum=float(ing['min']), maximum=float(ing['max'])))
        initial.append(float(ing['min']))
    

if __name__ == '__main__':
    
    send_to_ruby = len(sys.argv) > 1
    
    if send_to_ruby:
        load_nutrients_and_ingredients(json.loads(sys.argv[1]))
    else:
        load_nutrients_and_ingredients(test_json)
    
    find_rations()



# class MyTakeStep(object):
#     def __init__(self, stepsize=0.5):
#         self.stepsize = stepsize
#     def __call__(self, x):
#         # s = self.stepsize
#         # x[0] += np.random.uniform(-2.*s, 2.*s)
#         # x[1:] += np.random.uniform(-s, s, x[1:].shape)
        
#         # [Limestone, Wheat, Corn, Sunflower, SBM_Expelled, SBM, SoyaOil, Mononcalcium, BroilerStart, Lysine, Threonine, Methionine]
#         # bp()

#         sm = 0.25
#         big = 1

#         x[0] += np.random.uniform(-2.*sm, 2.*sm)
#         x[1] += np.random.uniform(-2.*big, 2.*big)
#         x[2] += np.random.uniform(-2.*big, 2.*big)
#         x[3] += np.random.uniform(-2.*big, 2.*big)

#         x[4] += np.random.uniform(-2.*big, 2.*big)
#         x[5] += np.random.uniform(-2.*big, 2.*big)
#         x[6] += np.random.uniform(-2.*sm, 2.*sm)
#         x[7] += np.random.uniform(-2.*sm, 2.*sm)
#         x[8] += np.random.uniform(-2.*sm, 2.*sm)
#         x[9] += np.random.uniform(-2.*sm, 2.*sm)
#         x[10] += np.random.uniform(-2.*sm, 2.*sm)
#         x[11] += np.random.uniform(-2.*sm, 2.*sm)

#         # x[1:] += np.random.uniform(-s, s, x[1:].shape)    
#         return x

# def bfgs(initial):
#     dollar_cost = find_cost(initial, base_cost=True)
#     print('Initial cost per KG ${:.2f}'.format(dollar_cost))
#     lowest_cost = 100
#     best_ration = initial
#     for x in range(5):
#         ret = minimize(
#             find_cost, best_ration, method='BFGS',
#             options=dict(disp=False),
#         )
#         cost = find_cost(ret.x)
#         print('Cost:', cost)
#         if cost < lowest_cost:
#             best_ration = ret.x

#     print(find_cost(best_ration, debug=True), '\n')
#     dollar_cost = find_cost(ret.x, base_cost=True)
#     print('Cost per KG ${:.2f}'.format(dollar_cost))
#     total_amount = sum(x for x in best_ration if x > 0)
#     for y, ingredient in enumerate(ingredients):
#         print('{}: {:.5f}%'.format(ingredient, (max(best_ration[y], 0) / total_amount) * 100))


# def forest(initial):
#     bounds = []
#     for ingredient in ingredients:
#         bounds.append((ingredient.minimum, ingredient.maximum))
#         res = skopt.forest_minimize(find_cost, bounds)
#         return res

# class MyBounds(object):
#     def __init__(self, xmax=[1.1,1.1], xmin=[-1.1,-1.1] ):
#         self.xmax = np.array(xmax)
#         self.xmin = np.array(xmin)

#     def __call__(self, **kwargs):
#         x = kwargs["x_new"]
#         tmax = bool(np.all(x <= self.xmax))
#         tmin = bool(np.all(x >= self.xmin))
#         return tmax and tmin

# class MyBoundaries(object):
#     def __init__(self, xmax=[1.1,1.1], xmin=[-1.1,-1.1] ):
#         self.xmax = np.array(xmax)
#         self.xmin = np.array(xmin)
#     def __call__(self, **kwargs):
       
#         if kwargs['f_new'] > 24:
            
#             return True

#         else:
#             info = get_nutrient_amounts(kwargs['x_new'])
#             amounts = info[0]

#             for nut_name, values in amounts.iteritems():
#                 diff = values[0].minimum - values[1]

#                 allowed_diff = 0.02 if nut_name == dig_arganine else 0.0

#                 if diff > allowed_diff:
#                     return False

#             return True
